---
title: "Power Analysis1_Base Analysis"
author: "Sophie Tascedda"
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
params:
  num_regions: '15'
---



```{r}
mu_zeros2=replicate(15,0)
sigma1=sample_covariance(Y_c_conv, num_regions, conventional_ids)
sigma1=Reduce("+", sigma1)/length(sigma1)

sigma2=sigma1

sigma2[2,1]=1.9*sigma1[2,1]
sigma2[3,1]=1.9*sigma1[3,1]
sigma2[3,2]=1.9*sigma1[3,2]
sigma2[4,1]=1.9*sigma1[4,1]
sigma2[4,2]=1.9*sigma1[4,2]
sigma2[4,3]=1.9*sigma1[4,3]

analysis_results3=list()
pvalues3=list()
n=10
for (i in 1:n){
lis_conv <- lapply(1:length(conventional_ids), mvrnorm, n=4800, mu=mu_zeros, Sigma=sigma1)
lis_short<-lapply(1:length(short_ids), mvrnorm, n=4800,mu=mu_zeros2,Sigma=sigma2)
X_for_short=X_short_subset
X_for_conv=X_conv_subset
  
Y_new_short<-lis_short
Y_new_conventional<-lis_conv

analysis3_sim3=base_analysis_full(Y_new_short, X_short_subset, Y_new_conventional, X_conv_subset, channel_names, short_ids, conventional_ids)

list_pvalues4=get_pvalues(analysis3_sim3$test)
list_pvalues4=as.double(list_pvalues4)

analysis_results3[[i]]=list()
analysis_results3[[i]]=analysis3_sim3
pvalues3[[i]]=list()
pvalues3[[i]]=list_pvalues4

i=i+1

}
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
